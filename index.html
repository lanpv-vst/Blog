<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>C√¢u chuy·ªán TSV & VBA c·ªßa H·∫£i</title>

    <style>
        body {
            margin: 0;
            font-family: "Segoe UI", sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        header {
            background: linear-gradient(135deg, #3f72af, #112d4e);
            color: white;
            padding: 80px 20px;
            text-align: center;
        }

        header h1 {
            font-size: 48px;
            margin-bottom: 10px;
        }

        header p {
            font-size: 20px;
            opacity: 0.9;
        }

        .section {
            max-width: 900px;
            margin: 60px auto;
            padding: 0 20px;
        }

        .story-block {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
            margin-bottom: 50px;
            padding: 30px;
            display: flex;
            gap: 25px;
            align-items: center;
        }

        .story-block img {
            width: 260px;
            height: 260px;
            border-radius: 14px;
            object-fit: cover;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
        }

        .story-text {
            flex: 1;
            font-size: 18px;
        }

        .code-box {
            background: #1e1e1e;
            color: #eee;
            padding: 15px;
            border-radius: 8px;
            font-family: Consolas, monospace;
            font-size: 15px;
            margin-top: 15px;
            overflow-x: auto;
        }

        footer {
            margin-top: 80px;
            background: #112d4e;
            color: white;
            padding: 40px 20px;
            text-align: center;
        }

        /* Fade-in Animation */
        .fade {
            opacity: 0;
            transform: translateY(30px);
            transition: 0.8s ease;
        }

        .fade.visible {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body>

<header>
    <h1>Chuy·ªán b√© Pi & File TSV K·ª≥ B√≠</h1>
    <p>Khi cu·ªôc ƒë·ªùi qu√° ng·∫Øn ƒë·ªÉ t√°ch c·ªôt b·∫±ng tay‚Ä¶ h√£y ƒë·ªÉ VBA lo ‚úîÔ∏è</p>
</header>

<div class="section">

    <!-- Block 1 -->
    <div class="story-block fade">
        <img src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExbmFlejE3am02dXVzanEwbXM0bDU0cm1xemhhMmE3ZWNnMGU5ajQ1YyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/ZOQF9JDBMDfEC6KtJC/giphy.gif" alt="Excel b·ªëi r·ªëi" />
        <div class="story-text">
            <p>B√© Pi v·ª´a t·∫£i xong m·ªôt file TSV t·ª´ TABMIS. M·ªü ra th√¨ Excel nh√¨n n√≥ nh∆∞ nh√¨n ng∆∞·ªùi l·∫° ngo√†i h√†nh tinh. C·ªôt d√≠nh nhau, s·ªë bay lo·∫°n x·∫°‚Ä¶</p>
            <p>B√© Pi th·ªü d√†i: <i>‚ÄúKh√¥ng l·∫Ω l·∫°i ng·ªìi t√°ch t·ª´ng c·ªôt nh∆∞ g·ª° b√°nh ƒëa?‚Äù</i></p>
        </div>
    </div>

    <!-- Block 2 -->
    <div class="story-block fade">
        <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExaWx4bng5MnNsazZhZjR1NHl3OXd0Mm5ybm45NmJobGN0ajB4ZzlibCZlcD12MV9naWZzX3NlYXJjaCZjdT1n/1noQjZGz89r3TqekG2/giphy.gif" alt="Hacker vibes cute" />
        <div class="story-text">
            <p>
                Kh√¥ng ch·ªãu n·ªïi c·∫£nh Excel h√†nh m√¨nh nh∆∞ ng∆∞·ªùi y√™u c≈©,
                b√© Pi quy·∫øt ƒë·ªãnh ch∆°i l·ªõn: d√πng VBA.  
                Nh∆∞ng kh·ªï n·ªói‚Ä¶ VBA v·ªõi Pi gi·ªëng nh∆∞ ti·∫øng c√° heo k√™u ‚Äî nghe vui nh∆∞ng ch·∫≥ng hi·ªÉu g√¨ ‚ùì
            </p>
            <p>
                Th·∫ø l√† Pi b·∫≠t ChatGPT v√† g√µ th·∫≠t m·∫°nh:
                <i><b>
                    ‚ÄúVi·∫øt cho t√¥i ƒëo·∫°n code VBA ƒë·ªÉ:
                    <br>1. M·ªü c·ª≠a s·ªï ch·ªçn file TSV.
                    <br>2. T·∫°o sheet m·ªõi t√™n dataX (X = t·ªïng s·ªë sheet + 1).
                    <br>3. N·∫°p d·ªØ li·ªáu TSV v√†o sheet m·ªõi, t·∫•t c·∫£ c·ªôt ƒë·ªÅu d·∫°ng text.
                    <br>Nh·ªõ ch·ªâ t√¥i c√°ch d√°n code v√† ch·∫°y n·ªØa!‚Äù
                </b></i>
            </p>
        </div>
    </div>

    <!-- Block 2.5 -->
    <div class="story-block fade">
        <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExb3ozYnU5bWdndnJsc250czZndmg3NTc0Y3lpMzRkcTIwMGo4MmtkaCZlcD12MV9naWZzX3NlYXJjaCZjdT1n/25KEhzwCBBFPb79puo/giphy.gif" alt="story time" />
        <div class="story-text">
            <p>
                ChatGPT m·ªâm c∆∞·ªùi ki·ªÉu ‚Äúƒë·ªÉ anh lo‚Äù r·ªìi ƒë∆∞a Pi ƒëo·∫°n code s√°ng l·∫•p l√°nh.
                Pi l·∫•y h·∫øt can ƒë·∫£m, nh·∫•n <b>Alt + F11</b> ‚ùó  
            </p>
            <p>
                C·ª≠a s·ªï VBA b·∫≠t l√™n‚Ä¶ nh√¨n c·ªï nh∆∞ di t√≠ch Windows XP, nh∆∞ng uy l·ª±c th√¨ v·∫´n nh∆∞ r·ªìng th·∫ßn trong truy·ªÅn thuy·∫øt.
            </p>

            <div class="code-box">
                Dim filePath As String <br/>
                Dim ws As Worksheet <br/><br/>

                filePath = Application.GetOpenFilename("TSV Files (*.tsv), *.tsv") <br/>
                Set ws = Sheets.Add <br/>
                ws.Name = "data" & Sheets.Count <br/><br/>
                ..................................................................<br/>
                End With <br/><br/>

                ' ' (ƒê·ª´ng r·ªùi ƒëi khi ch∆∞a xem ƒëo·∫°n code cu·ªëi trang ‚Äî n√≥ bu·ªìn ƒë·∫•y üòÜ)
            </div>

            <p>
                Nh√¨n ƒëo·∫°n code d√†i h∆°n ƒë·ªùi sinh vi√™n nƒÉm nh·∫•t,  
                b√© Pi c·∫£m gi√°c m√¨nh bi·∫øn th√†nh hacker x·ªãn ‚Äî ch·ªâ thi·∫øu c√°i k√≠nh r√¢m v√† ti·∫øng b√†n ph√≠m g√µ *l√°ch t√°ch* ph√≠a sau üòéüíª.
            </p>
        </div>
    </div>

    <!-- Block 3 -->
    <div class="story-block fade">
        <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExM2V5MHBzcWRqcGJpMzF2YjkwMnN4cjcxMXJkNmEzcDNoeW1mcWFnaSZlcD12MV9naWZzX3NlYXJjaCZjdT1n/fasjTJwTFW2goeR2uV/giphy.gif" alt="Excel g·ªçn g√†ng" />
        <div class="story-text">
            <p>B√© Pi ch·∫°y macro. Excel thong th·∫£ h·ªèi:</p>
            <p><b>‚ÄúCh·ªçn file ƒëi b·∫°n tr·∫ª.‚Äù</b></p>
            <p>B√© Pi ch·ªçn file TSV. M·ªôt gi√¢y sau, sheet m·ªõi hi·ªán ra. D·ªØ li·ªáu g·ªçn g√†ng nh∆∞ v·ª´a ƒë∆∞·ª£c ·ªßi ph·∫≥ng ‚ú®</p>
        </div>
    </div>

    <!-- Block 4 -->
    <div class="story-block fade">
        <img src="https://media.giphy.com/media/v1.Y2lkPWVjZjA1ZTQ3c3FpeWo5NHE2anRlaGVsa2RzZ2V2bjA2cHhtOGV3cHYzM3ZhbTRkZSZlcD12MV9naWZzX3NlYXJjaCZjdT1n/ES4Vcv8zWfIt2/giphy.gif" alt="C√† ph√™ b√¨nh y√™n" />
        <div class="story-text">
            <p>B√© Pi d·ª±a l∆∞ng, khoanh tay:</p>
            <p><i>‚ÄúV·∫≠y m√† bao nƒÉm nay m√¨nh ƒëi t√°ch c·ªôt b·∫±ng tay nh∆∞ n√¥ng d√¢n th·ªùi k·ª≥ ƒë·ªì ƒë√°.‚Äù</i></p>

            <p>T·ª´ ƒë√≥ tr·ªü ƒëi, m·ªói khi th·∫•y TSV c·ªßa TABMIS, B√© Pi ch·ªâ m·ªâm c∆∞·ªùi.  
            VBA lo h·∫øt.  
            Ch·ªâ c√≤n l·∫°i B√© Pi v√† t√°ch c√† ph√™ b√¨nh y√™n ‚òï.</p>
        </div>
    </div>
    <div class="code-box">
<br/>
&lt;!-- CODE VBA ƒê·∫¶Y ƒê·ª¶ ‚Äì COPY ƒê∆Ø·ª¢C NGAY üòé --&gt;<br/><br/>

Sub Import_Auto_Universal(control As IRibbonControl)<br/>
&nbsp;&nbsp;Dim fd As FileDialog<br/>
&nbsp;&nbsp;Dim filePath As String, fileExt As String, folderPath As String<br/>
&nbsp;&nbsp;Dim ws As Worksheet, qt As QueryTable<br/>
&nbsp;&nbsp;Dim FileName As String, TenSheet As String<br/>
&nbsp;&nbsp;Dim i As Long, delimiter As String<br/><br/>

&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;' 1. Ch·ªçn file b·∫•t k·ª≥ (CSV, TSV, TXT, LOG‚Ä¶)<br/>
&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;Set fd = Application.FileDialog(msoFileDialogFilePicker)<br/>
&nbsp;&nbsp;With fd<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.Title = "Ch·ªçn file d·ªØ li·ªáu c·∫ßn m·ªü"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.Filters.Clear<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.Filters.Add "Text Data", "*.csv; *.tsv; *.txt; *.log; *.dat", 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.AllowMultiSelect = False<br/>
&nbsp;&nbsp;&nbsp;&nbsp;If .Show &lt;&gt; -1 Then Exit Sub<br/>
&nbsp;&nbsp;&nbsp;&nbsp;filePath = .SelectedItems(1)<br/>
&nbsp;&nbsp;End With<br/><br/>

&nbsp;&nbsp;folderPath = Left(filePath, InStrRev(filePath, "\") - 1)<br/><br/>

&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;' 2. Nh·∫≠n bi·∫øt delimiter b·∫±ng AI logic<br/>
&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;delimiter = DetectDelimiter(filePath)<br/><br/>

&nbsp;&nbsp;If delimiter = "" Then<br/>
&nbsp;&nbsp;&nbsp;&nbsp;MsgBox "Kh√¥ng th·ªÉ nh·∫≠n di·ªán delimiter!", vbCritical<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Exit Sub<br/>
&nbsp;&nbsp;End If<br/><br/>

&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;' 3. T·∫°o sheet t·ª´ t√™n file<br/>
&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;FileName = Split(filePath, "\")(UBound(Split(filePath, "\")))<br/>
&nbsp;&nbsp;TenSheet = Left(FileName, InStrRev(FileName, ".") - 1)<br/>
&nbsp;&nbsp;TenSheet = Left(TenSheet, 30)<br/><br/>

&nbsp;&nbsp;On Error Resume Next<br/>
&nbsp;&nbsp;Set ws = ThisWorkbook.Sheets(TenSheet)<br/>
&nbsp;&nbsp;On Error GoTo 0<br/><br/>

&nbsp;&nbsp;If ws Is Nothing Then<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Set ws = ThisWorkbook.Sheets.Add(After:=Sheets(Sheets.Count))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;ws.Name = TenSheet<br/>
&nbsp;&nbsp;Else<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Set ws = ThisWorkbook.Sheets.Add(After:=Sheets(Sheets.Count))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;ws.Name = TenSheet & "_" & Format(Now, "hhmmss")<br/>
&nbsp;&nbsp;End If<br/><br/>

&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;' 4. D·ªçn d·ªØ li·ªáu c≈©<br/>
&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;ws.Cells.Clear<br/>
&nbsp;&nbsp;For Each qt In ws.QueryTables<br/>
&nbsp;&nbsp;&nbsp;&nbsp;qt.Delete<br/>
&nbsp;&nbsp;Next qt<br/><br/>

&nbsp;&nbsp;Application.ScreenUpdating = False<br/><br/>

&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;' 5. Import file<br/>
&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;With ws.QueryTables.Add(Connection:="TEXT;" & filePath, Destination:=ws.Range("A1"))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.TextFileParseType = xlDelimited<br/><br/>

&nbsp;&nbsp;&nbsp;&nbsp;.TextFileCommaDelimiter = False<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.TextFileSemicolonDelimiter = False<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.TextFileTabDelimiter = False<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.TextFileOtherDelimiter = False<br/><br/>

&nbsp;&nbsp;&nbsp;&nbsp;Select Case delimiter<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case ",": .TextFileCommaDelimiter = True<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case ";": .TextFileSemicolonDelimiter = True<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case vbTab: .TextFileTabDelimiter = True<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case "|": .TextFileOtherDelimiter = True: .TextFileOtherDelimiter = "|"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case Else: .TextFileOtherDelimiter = True: .TextFileOtherDelimiter = delimiter<br/>
&nbsp;&nbsp;&nbsp;&nbsp;End Select<br/><br/>

&nbsp;&nbsp;&nbsp;&nbsp;Dim TextCols(1 To 500) As Long<br/>
&nbsp;&nbsp;&nbsp;&nbsp;For i = 1 To 500<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextCols(i) = xlTextFormat<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Next i<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.TextFileColumnDataTypes = TextCols<br/><br/>

&nbsp;&nbsp;&nbsp;&nbsp;.TextFilePlatform = 65001<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.TextFileTextQualifier = xlTextQualifierDoubleQuote<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.Refresh BackgroundQuery:=False<br/>
&nbsp;&nbsp;End With<br/><br/>

&nbsp;&nbsp;ws.UsedRange.NumberFormat = "@"<br/>
&nbsp;&nbsp;ws.Columns.AutoFit<br/><br/>

&nbsp;&nbsp;Application.ScreenUpdating = True<br/><br/>

&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;' 6. M·ªü folder ch·ª©a file<br/>
&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;Shell "explorer.exe """ & folderPath & """", vbNormalFocus<br/><br/>

&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;' 7. Th√¥ng b√°o<br/>
&nbsp;&nbsp;'==================================================<br/>
&nbsp;&nbsp;MsgBox "ƒê√£ import th√†nh c√¥ng!" & vbCrLf & vbCrLf & _<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"File: " & FileName & vbCrLf & _<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Delimiter nh·∫≠n di·ªán: " & Replace(delimiter, vbTab, "TAB") & vbCrLf & _<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Sheet m·ªõi: " & ws.Name, _<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vbInformation, "TH√ÄNH C√îNG"<br/><br/>

End Sub<br/><br/>

'===========================================================<br/>
'  H√ÄM T·ª∞ ƒê·ªòNG NH·∫¨N BI·∫æT DELIMITER (AI LOGIC)<br/>
'===========================================================<br/>
Function DetectDelimiter(path As String) As String<br/>
&nbsp;&nbsp;Dim f As Integer: f = FreeFile<br/>
&nbsp;&nbsp;Dim firstLine As String<br/>
&nbsp;&nbsp;Dim dCandidates As Variant<br/>
&nbsp;&nbsp;Dim d As Variant, count As Long, bestCount As Long<br/>
&nbsp;&nbsp;Dim bestDelimiter As String<br/><br/>

&nbsp;&nbsp;dCandidates = Array(",", ";", vbTab, "|")<br/><br/>

&nbsp;&nbsp;On Error GoTo ErrHandler<br/><br/>

&nbsp;&nbsp;Open path For Input As #f<br/>
&nbsp;&nbsp;Line Input #f, firstLine<br/>
&nbsp;&nbsp;Close #f<br/><br/>

&nbsp;&nbsp;bestDelimiter = ""<br/>
&nbsp;&nbsp;bestCount = 0<br/><br/>

&nbsp;&nbsp;For Each d In dCandidates<br/>
&nbsp;&nbsp;&nbsp;&nbsp;count = UBound(Split(firstLine, d))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;If count &gt; bestCount Then<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bestCount = count<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bestDelimiter = d<br/>
&nbsp;&nbsp;&nbsp;&nbsp;End If<br/>
&nbsp;&nbsp;Next d<br/><br/>

&nbsp;&nbsp;DetectDelimiter = bestDelimiter<br/>
&nbsp;&nbsp;Exit Function<br/><br/>

ErrHandler:<br/>
&nbsp;&nbsp;DetectDelimiter = ""<br/>
End Function<br/>

<br/>
' (Code ·ªü cu·ªëi trang ‚Äî m·ªü l√™n l√† IQ tƒÉng 3 ƒëi·ªÉm üòÜ)<br/>
</div>

</div>

<footer>
    <p>¬© 2025 ‚Äì C√¢u chuy·ªán nh·ªè d√†nh cho nh·ªØng ng∆∞·ªùi l·ªõn l√™n c√πng Excel.</p>
</footer>

<script>
    const fades = document.querySelectorAll('.fade');

    const reveal = () => {
        const trigger = window.innerHeight * 0.85;
        fades.forEach(el => {
            const top = el.getBoundingClientRect().top;
            if (top < trigger) el.classList.add('visible');
        });
    };

    window.addEventListener('scroll', reveal);
    window.addEventListener('load', reveal);
</script>

</body>
</html>
